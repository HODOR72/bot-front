"use strict";(self.webpackChunk_it_meteor_admin=self.webpackChunk_it_meteor_admin||[]).push([[779],{80779:function(e,n,t){t.r(n),t.d(n,{default:function(){return q}});var r=t(20803),a=t(58561),s=t(53451),i=t(72791),o=t(59434),c=t(9440),u=t(15861),l=t(64687),d=t.n(l),h=t(92033),p=t(17449),f=h.Z.axiosBase;var x=t(42982),v=t(96015),m=t(4565),g=t(17205),Z=t(64802),j=t(34045),b=t(80184),k=function(e){var n=e.actionsList,t=function(e){var n=j.P6.book_new(),t=[["\u0414\u0430\u0442\u0430","ID","\u0417\u0430\u043a\u0430\u0437","\u0422\u0435\u043b\u0435\u0444\u043e\u043d","ID \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"]].concat((0,x.Z)(e.map((function(e){return[r(e.date),e.id,e.order,e.phone,e.userId]})))),a=j.P6.aoa_to_sheet(t);return j.P6.book_append_sheet(n,a,"Sheet 1"),n},r=function(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};return(0,b.jsxs)(v.Z,{sx:{display:"flex",gap:2,mb:4},children:[(0,b.jsx)(m.Z,{variant:"h3",component:"h1",paragraph:!0,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432"}),(0,b.jsx)(g.Z,{size:"large",variant:"contained",onClick:function(){return function(e,n){var t=n(e),r=j.cW(t,{type:"array",bookType:"xlsx"}),a=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,Z.saveAs)(a,"historyActions.xlsx")}(n,t)},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]})},w=function(e){var n=e.userList,t=function(e){var n=j.P6.book_new();console.log(e);var t=[["\u0418\u043c\u044f","\u0424\u0430\u043c\u0438\u043b\u0438\u044f","\u041d\u0438\u043a\u043d\u0435\u0439\u043c","\u0422\u0435\u043b\u0435\u0444\u043e\u043d","ID \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"]].concat((0,x.Z)(e.map((function(e){return[e.name,e.surname,e.nickname,e.phone,e.userId]})))),r=j.P6.aoa_to_sheet(t);return j.P6.book_append_sheet(n,r,"Sheet 1"),n};return(0,b.jsxs)(v.Z,{sx:{display:"flex",gap:2,mb:4},children:[(0,b.jsx)(m.Z,{variant:"h3",component:"h1",paragraph:!0,children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"}),(0,b.jsx)(g.Z,{size:"large",variant:"contained",onClick:function(){return function(e,n){var t=n(e),r=j.cW(t,{type:"array",bookType:"xlsx"}),a=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,Z.saveAs)(a,"usersList.xlsx")}(n,t)},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]})},I=t(70885),y=t(88055),W=t(79365),_=t(54479),C=t(34420),L=t(63360),S=t(75017),P=t(38254),A=t(35702),D=t(54585),B=t(71747),T=t(86951),z=t(46865),M=t(77483),F=h.Z.axiosBase;function E(e){return(0,u.Z)(d().mark((function n(){var t;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,F.get("sendMessages?users=".concat(e.users.join(","),"&message=").concat(e.message));case 3:return t=n.sent,(0,c.WI)((0,M.mJ)(t.data.data)),n.abrupt("return",!0);case 8:n.prev=8,n.t0=n.catch(0),(0,c.WI)((0,M.xT)(n.t0));case 11:return n.abrupt("return",!1);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})))}var J=function(e){var n,t=e.userList,r=(0,T.Ds)().enqueueSnackbar,a=(0,i.useState)(!1),s=(0,I.Z)(a,2),o=s[0],l=s[1],h=(0,i.useState)([]),p=(0,I.Z)(h,2),f=p[0],x=p[1],Z=(0,i.useState)(""),j=(0,I.Z)(Z,2),k=j[0],w=j[1],M=(0,i.useState)(""),F=(0,I.Z)(M,2),J=F[0],R=F[1],U=(0,i.useState)(1),q=(0,I.Z)(U,2),G=q[0],K=q[1],O=(0,i.useMemo)((function(){return t.filter((function(e){return function(e,n){return e.toLowerCase().indexOf(n.toLowerCase())>-1}(e.nickname,k)}))}),[k]),V=Math.ceil(O.length/8),H=8*(G-1),N=H+8;if(k.trim()){var Q=O.length,X=Math.ceil(Q/8);n=0===Q?[]:Q<=8?O:G===X?O.slice(H):O.slice(H,N)}else n=O.slice(H,N);var Y=function(){var e=(0,u.Z)(d().mark((function e(){var n,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==f.length){e.next=2;break}return e.abrupt("return",r("\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439",{variant:"error"}));case 2:if(""!==J.trim()){e.next=4;break}return e.abrupt("return",r("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",{variant:"error"}));case 4:return n=f.map((function(e){var n=t.find((function(n){return n.nickname===e}));return n?n.userId:null})),a=n.filter((function(e){return null!==e})),x([]),R(""),e.next=10,(0,c.WI)(E({users:a,message:J}));case 10:return e.abrupt("return",r("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e",{variant:"success"}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Z,{variant:"h3",component:"h1",paragraph:!0,children:"\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439"}),(0,b.jsxs)(v.Z,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap",mb:4},children:[(0,b.jsxs)(y.Z,{fullWidth:!0,sx:{maxWidth:320,width:"100%"},children:[(0,b.jsx)(W.Z,{id:"search-select-label",children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"}),(0,b.jsxs)(_.Z,{MenuProps:{autoFocus:!1},labelId:"search-select-label",id:"search-select",value:f,label:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438",multiple:!0,input:(0,b.jsx)(C.Z,{label:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"}),renderValue:function(e){return e.join(", ")},onChange:function(e){var n;return x(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value)},onClose:function(){return w("")},children:[(0,b.jsx)(L.Z,{sx:{marginBottom:2},children:(0,b.jsx)(g.Z,{size:"large",variant:"contained",sx:{width:"100%"},onClick:function(){l(!o),x(o?[]:t.map((function(e){return e.nickname})))},children:o?"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u044b\u0431\u043e\u0440 \u0432\u0441\u0435\u0445":"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0435\u0445"})}),(0,b.jsx)(L.Z,{children:(0,b.jsx)(S.Z,{size:"small",autoFocus:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a...",fullWidth:!0,InputProps:{startAdornment:(0,b.jsx)(P.Z,{position:"start",children:(0,b.jsx)(z.Z,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})},onChange:function(e){return w(e.target.value)},onKeyDown:function(e){"Escape"!==e.key&&e.stopPropagation()}})}),n.map((function(e,n){return(0,b.jsx)(A.Z,{value:e.nickname,children:e.nickname},n)})),(0,b.jsx)(v.Z,{sx:{marginTop:2,display:"flex",justifyContent:"center"},children:(0,b.jsx)(D.Z,{count:V,page:G,onChange:function(e,n){K(n)},variant:"outlined",shape:"rounded",color:"primary"})})]})]}),(0,b.jsx)(B.Z,{id:"outlined-basic",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",minRows:3,maxRows:10,value:J,onChange:function(e){return function(e){var n;(null===(n=String(e))||void 0===n?void 0:n.length)<=4095&&R(e)}(e.target.value)},style:{maxWidth:320,width:"100%"}}),(0,b.jsx)(g.Z,{size:"large",variant:"contained",onClick:Y,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]})},R=t(26649),U=h.Z.axiosBase;function q(){var e=(0,a.Z)().themeStretch,n=(0,o.v9)((function(e){return e.user})),t=n.userList,l=n.userListParams;(0,i.useEffect)((function(){var e;(0,c.WI)((e=l,(0,u.Z)(d().mark((function n(){var t;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(0,c.WI)((0,p.Av)()),n.prev=1,n.next=4,f.get("getUsers",{params:e});case 4:t=n.sent,console.log(t.data),(0,c.WI)((0,p.bG)(t.data)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),(0,c.WI)((0,p.xT)(n.t0));case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))))}),[c.WI,l]);var h=(0,o.v9)((function(e){return e.actions})),x=h.actionsList,v=h.actionsListParams;return(0,i.useEffect)((function(){var e;(0,c.WI)((e=v,(0,u.Z)(d().mark((function n(){var t;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(0,c.WI)((0,R.Av)()),n.prev=1,n.next=4,U.get("getActions",{params:e});case 4:t=n.sent,console.log(t.data),(0,c.WI)((0,R.dJ)(t.data)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),(0,c.WI)((0,R.xT)(n.t0));case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))))}),[c.WI,v]),(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(s.Z,{title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",children:(0,b.jsxs)(r.Z,{maxWidth:!e&&"xl",children:[t&&t.length>0&&(0,b.jsx)(J,{userList:t}),t&&t.length>0&&(0,b.jsx)(w,{userList:t}),x&&x.length>0&&(0,b.jsx)(k,{actionsList:x})]})})})}}}]);
//# sourceMappingURL=779.3bed0b5e.chunk.js.map