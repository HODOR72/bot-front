"use strict";(self.webpackChunk_it_meteor_admin=self.webpackChunk_it_meteor_admin||[]).push([[779],{80779:function(e,n,t){t.r(n),t.d(n,{default:function(){return G}});var r=t(20803),a=t(58561),s=t(53451),i=t(72791),o=t(59434),c=t(9440),u=t(15861),l=t(64687),d=t.n(l),p=t(92033),h=t(17449),f=p.Z.axiosBase;var x=t(42982),m=t(96015),v=t(4565),g=t(17205),Z=t(64802),b=t(34045),j=t(80184),k=function(e){var n=e.actionsList,t=function(e){var n=b.P6.book_new(),t=[["\u0414\u0430\u0442\u0430","ID","\u0417\u0430\u043a\u0430\u0437","\u0422\u0435\u043b\u0435\u0444\u043e\u043d","ID \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"]].concat((0,x.Z)(e.map((function(e){return[r(e.date),e.id,e.order,e.phone,e.userId]})))),a=b.P6.aoa_to_sheet(t);return b.P6.book_append_sheet(n,a,"Sheet 1"),n},r=function(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};return(0,j.jsxs)(m.Z,{sx:{display:"flex",gap:2,mb:4},children:[(0,j.jsx)(v.Z,{variant:"h3",component:"h1",paragraph:!0,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432"}),(0,j.jsx)(g.Z,{size:"large",variant:"contained",onClick:function(){return function(e,n){var t=n(e),r=b.cW(t,{type:"array",bookType:"xlsx"}),a=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,Z.saveAs)(a,"historyActions.xlsx")}(n,t)},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]})},w=function(e){var n=e.userList,t=function(e){var n=b.P6.book_new();console.log(e);var t=[["\u0418\u043c\u044f","\u0424\u0430\u043c\u0438\u043b\u0438\u044f","\u041d\u0438\u043a\u043d\u0435\u0439\u043c","\u0422\u0435\u043b\u0435\u0444\u043e\u043d","ID \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"]].concat((0,x.Z)(e.map((function(e){return[e.name,e.surname,e.nickname,e.phone,e.userId]})))),r=b.P6.aoa_to_sheet(t);return b.P6.book_append_sheet(n,r,"Sheet 1"),n};return(0,j.jsxs)(m.Z,{sx:{display:"flex",gap:2,mb:4},children:[(0,j.jsx)(v.Z,{variant:"h3",component:"h1",paragraph:!0,children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"}),(0,j.jsx)(g.Z,{size:"large",variant:"contained",onClick:function(){return function(e,n){var t=n(e),r=b.cW(t,{type:"array",bookType:"xlsx"}),a=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,Z.saveAs)(a,"usersList.xlsx")}(n,t)},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})]})},y=t(70885),I=t(60277),W=t(71747),_=t(88055),C=t(79365),L=t(54479),P=t(34420),S=t(63360),A=t(75017),B=t(38254),D=t(35702),z=t(54585),M=t(86951),T=t(46865),F=t(77483),E=p.Z.axiosBase;function J(e){return(0,u.Z)(d().mark((function n(){var t;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,E.get("sendMessages?users=".concat(e.users.join(","),"&message=").concat(e.message));case 3:return t=n.sent,(0,c.WI)((0,F.mJ)(t.data.data)),n.abrupt("return",!0);case 8:n.prev=8,n.t0=n.catch(0),(0,c.WI)((0,F.xT)(n.t0));case 11:return n.abrupt("return",!1);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})))}var R=function(e){var n,t=e.userList,r=(0,M.Ds)().enqueueSnackbar,a=(0,i.useState)(!1),s=(0,y.Z)(a,2),o=s[0],l=s[1],p=(0,i.useState)([]),h=(0,y.Z)(p,2),f=h[0],x=h[1],Z=(0,i.useState)(""),b=(0,y.Z)(Z,2),k=b[0],w=b[1],F=(0,i.useState)(""),E=(0,y.Z)(F,2),R=E[0],U=E[1],q=(0,i.useState)(1),G=(0,y.Z)(q,2),K=G[0],O=G[1],V=(0,i.useMemo)((function(){return(Array.isArray(t)?t:[]).filter((function(e){return function(e,n){return e.toLowerCase().indexOf(n.toLowerCase())>-1}(e.nickname,k)}))}),[t,k]),H=Math.ceil(V.length/8),N=8*(K-1),Q=N+8;if(k.trim()){var X=V.length,Y=Math.ceil(X/8);n=0===X?[]:X<=8?V:K===Y?V.slice(N):V.slice(N,Q)}else n=V.slice(N,Q);var $=function(){var e=(0,u.Z)(d().mark((function e(){var n,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==f.length){e.next=2;break}return e.abrupt("return",r("\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439",{variant:"error"}));case 2:if(""!==R.trim()){e.next=4;break}return e.abrupt("return",r("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",{variant:"error"}));case 4:return n=f.map((function(e){var n=t.find((function(n){return n.nickname===e}));return n?n.userId:null})),a=n.filter((function(e){return null!==e})),x([]),U(""),e.next=10,(0,c.WI)(J({users:a,message:R}));case 10:return e.abrupt("return",r("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e",{variant:"success"}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=(0,I.ZP)(W.Z)((function(e){e.theme;return"\n    width: 320px;\n    font-family: IBM Plex Sans, sans-serif;\n    font-size: 0.875rem;\n    font-weight: 400;\n    line-height: 1.5;\n    padding: 12px;\n    border-radius: 12px 12px 0 12px;\n    border: 1px solid #d0d7de;\n  \n    &:focus-visible {\n      outline: 0;\n    }\n  "}));return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(v.Z,{variant:"h3",component:"h1",paragraph:!0,children:"\u0420\u0430\u0441\u0441\u044b\u043b\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439"}),(0,j.jsxs)(m.Z,{sx:{display:"flex",gap:2,flexWrap:"wrap",mb:4},children:[(0,j.jsxs)(_.Z,{fullWidth:!0,sx:{maxWidth:320,width:"100%"},children:[(0,j.jsx)(C.Z,{id:"search-select-label",children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"}),(0,j.jsxs)(L.Z,{MenuProps:{autoFocus:!1},labelId:"search-select-label",id:"search-select",value:f,label:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438",multiple:!0,input:(0,j.jsx)(P.Z,{label:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"}),renderValue:function(e){return e.join(", ")},onChange:function(e){var n;return x(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value)},onClose:function(){return w("")},sx:{padding:.72},children:[(0,j.jsx)(S.Z,{sx:{marginBottom:2},children:(0,j.jsx)(g.Z,{size:"large",variant:"contained",sx:{width:"100%"},onClick:function(){l(!o),x(o?[]:t.map((function(e){return e.nickname})))},children:o?"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u044b\u0431\u043e\u0440 \u0432\u0441\u0435\u0445":"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0435\u0445"})}),(0,j.jsx)(S.Z,{children:(0,j.jsx)(A.Z,{size:"small",autoFocus:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a...",fullWidth:!0,InputProps:{startAdornment:(0,j.jsx)(B.Z,{position:"start",children:(0,j.jsx)(T.Z,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})},onChange:function(e){return w(e.target.value)},onKeyDown:function(e){"Escape"!==e.key&&e.stopPropagation()}})}),n.map((function(e,n){return(0,j.jsx)(D.Z,{value:e.nickname,children:e.nickname},n)})),(0,j.jsx)(m.Z,{sx:{marginTop:2,display:"flex",justifyContent:"center"},children:(0,j.jsx)(z.Z,{count:H,page:K,onChange:function(e,n){O(n)},variant:"outlined",shape:"rounded",color:"primary"})})]})]}),(0,j.jsx)(ee,{id:"outlined-basic",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",minRows:2,maxRows:10,value:R,onChange:function(e){return function(e){var n;(null===(n=String(e))||void 0===n?void 0:n.length)<=4095&&U(e)}(e.target.value)},style:{maxWidth:320,width:"100%"}}),(0,j.jsx)(g.Z,{size:"large",variant:"contained",onClick:$,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]})},U=t(26649),q=p.Z.axiosBase;function G(){var e=(0,a.Z)().themeStretch,n=(0,o.v9)((function(e){return e.user})),t=n.userList,l=n.userListParams;(0,i.useEffect)((function(){var e;l&&(0,c.WI)((e=l,(0,u.Z)(d().mark((function n(){var t;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(0,c.WI)((0,h.Av)()),n.prev=1,n.next=4,f.get("getUsers",{params:e});case 4:t=n.sent,console.log(t.data),(0,c.WI)((0,h.bG)(t.data)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),(0,c.WI)((0,h.xT)(n.t0));case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))))}),[c.WI,l]);var p=(0,o.v9)((function(e){return e.actions})),x=p.actionsList,m=p.actionsListParams;return(0,i.useEffect)((function(){var e;m&&(0,c.WI)((e=m,(0,u.Z)(d().mark((function n(){var t;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(0,c.WI)((0,U.Av)()),n.prev=1,n.next=4,q.get("getActions",{params:e});case 4:t=n.sent,console.log(t.data),(0,c.WI)((0,U.dJ)(t.data)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),(0,c.WI)((0,U.xT)(n.t0));case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))))}),[c.WI,m]),(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(s.Z,{title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",children:(0,j.jsxs)(r.Z,{maxWidth:!e&&"xl",children:[(0,j.jsx)(R,{userList:t||[]}),(0,j.jsx)(w,{userList:t||[]}),(0,j.jsx)(k,{actionsList:x||[]})]})})})}}}]);
//# sourceMappingURL=779.d61e8f67.chunk.js.map